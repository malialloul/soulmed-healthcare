{"ast":null,"code":"var _jsxFileName = \"/home/ma/soulmed-healthcare/src/views/doctor/schedule-settings.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { doctorController } from \"../../controllers/doctor\";\nimport Layout from \"./layout\";\nimport \"../../css/schedule-settings.css\";\nimport moment from \"moment\";\nimport { useNavigate } from \"react-router-dom\";\nimport { util } from \"../../public/util\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst ScheduleSettings = () => {\n  _s();\n\n  const {\n    id\n  } = useParams();\n  const [loading, setLoading] = useState(true);\n  const [schedueList, setSchdeuleList] = useState([]);\n  const [doctorData, setDoctorData] = useState({\n    id: -1,\n    name: \"\",\n    country: \"\",\n    profession_fk: -1,\n    city: \"\",\n    Price: \"\",\n    location: []\n  });\n  const [timingIndexCount, setTimingIndexCount] = useState(-1);\n  const [addTimingDisbaled, setAddTimingDisabled] = useState(false);\n  useEffect(() => {\n    doctorController.getDoctorInfo(id).then(response => {\n      setDoctorData(response.data);\n    }).then(() => {\n      doctorController.getDoctorSchedule(id).then(res => {\n        setSchdeuleList(res.data);\n        setTimingIndexCount(res.data.length > 0 ? res.data[res.data.length - 1].id + 1 : 1);\n      }).then(() => {\n        setLoading(false);\n      });\n    });\n  }, []);\n  const daysOfWeek = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"];\n  const [timingArray, setTimingarray] = useState([]);\n\n  const addTiming = () => {\n    setAddTimingDisabled(true);\n    let temp = timingArray;\n    temp = [...temp, {\n      id: timingIndexCount,\n      start: \"\",\n      end: \"\",\n      type: 0\n    }];\n    setTimingarray(temp);\n    setTimingIndexCount(timingIndexCount + 1);\n    console.log(timingArray);\n  };\n\n  const deleteTiming = (id, index) => {\n    if (index === timingArray.length - 1) {\n      setAddTimingDisabled(false);\n    }\n\n    let temp = timingArray;\n    temp = timingArray.filter(timing => timing.id !== id);\n    setTimingarray(temp);\n  };\n\n  const modifyStartTiming = (index, value) => {\n    let temp = [...timingArray];\n    temp[index].start = value;\n    setTimingarray(temp);\n  };\n\n  const modifyEndTiming = (index, value) => {\n    let temp = [...timingArray];\n    temp[index].end = value;\n    setTimingarray(temp);\n\n    if (temp[temp.length - 1].start !== \"\") {\n      setAddTimingDisabled(false);\n    }\n  };\n\n  const modifyAppointmentsType = (index, value) => {\n    let temp = [...timingArray];\n    temp[index].type = value;\n    setTimingarray(temp);\n  };\n\n  const [location, setLocation] = useState(\"\");\n  const [daysSelected, setDaysSelected] = useState([]);\n  const navigate = useNavigate();\n\n  const updateSchedule = () => {\n    if (previousWeekSchedule) {\n      let thisWeekScheduleList = [];\n\n      for (let i = -7; i <= 0; i++) {\n        let previousWeekDay = moment(util.getDayDate(i)).format(\"YYYY-MM-DD\");\n\n        for (let i = 0; i < schedueList.length; i++) {\n          if (util.sameDay(schedueList[i].start, previousWeekDay)) {\n            let daySchedule = schedueList[i];\n            daySchedule.id = timingIndexCount;\n            thisWeekScheduleList.push(daySchedule);\n          }\n        }\n      }\n    } else {\n      let overlapping = false;\n      let emptyFields = false;\n      let validIntervals = true;\n      let newTimingDates = [];\n      let count = 0;\n\n      for (let i = 0; i < timingArray.length; i++) {\n        for (let j = 0; j < daysSelected.length; j++) {\n          newTimingDates = [...newTimingDates, {\n            id: timingArray[i].id,\n            doctor_fk: parseInt(id),\n            start: moment(util.getDayDate(daysOfWeek.indexOf(daysSelected[j]))).format(\"YYYY-MM-DD\") + \"T\" + timingArray[i].start,\n            end: moment(util.getDayDate(daysOfWeek.indexOf(daysSelected[j]))).format(\"YYYY-MM-DD\") + \"T\" + timingArray[i].end,\n            location: location,\n            type: parseInt(timingArray[i].type)\n          }];\n          count++;\n        }\n      }\n\n      console.log(newTimingDates);\n\n      for (let i = 0; i < newTimingDates.length; i++) {\n        if (util.isOverlapping(newTimingDates[i], newTimingDates)) {\n          overlapping = true;\n        }\n\n        if (newTimingDates[i].start === \"\" || newTimingDates[i].end === \"\" || newTimingDates[i].type === \"\") {\n          emptyFields = true;\n        }\n\n        if (!util.isValidTimingInterval(newTimingDates[i].start, newTimingDates[i].end)) {\n          validIntervals = false;\n        }\n      }\n\n      let success = true;\n\n      if (overlapping) {\n        alert(\"Two intervals are overlapping\");\n        success = false;\n      }\n\n      if (emptyFields || location === \"\") {\n        alert(\"Please fill all fields\");\n        success = false;\n      }\n\n      if (daysSelected.length === 0) {\n        alert(\"Select at least one day\");\n        success = false;\n      }\n\n      if (!validIntervals) {\n        alert(\"Invalid Timings\");\n        success = false;\n      }\n\n      if (success) {\n        for (let j = 0; j < newTimingDates.length; j++) {\n          doctorController.addDoctorAppointmentSchedule(newTimingDates[j]);\n        }\n\n        alert(\"Schedule Updated\"); //   navigate(\"/doctor/dashboard/\");\n      }\n    }\n  };\n\n  const handleChange = (e, data) => {\n    const {\n      name,\n      checked\n    } = e.target;\n\n    if (checked) {\n      // if cheked and selectall checkbox add all fileds to selectedList\n      if (name === \"allSelect\") {\n        let temp = daysOfWeek;\n        setDaysSelected(temp);\n      } else {\n        // if cheked and specific checkbox add specific field to selectedList\n        setDaysSelected([...daysSelected, name]);\n      }\n    } else {\n      // if uncheked and selectall checkbox add remove all fileds from selectedList\n      if (name === \"allSelect\") {\n        setDaysSelected([]);\n      } else {\n        // if uncheked and specific checkbox remove specific field from selectedList\n        let tempSelected = daysSelected.filter((item, i) => item !== name);\n        setDaysSelected(tempSelected);\n      }\n    }\n  };\n\n  const [previousWeekSchedule, setPreviousWeekSchedule] = useState(true);\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: !loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-8 schedule-div\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Weekly Schedule (From\", \" \", util.getDayDate(0).toString().substring(0, 15), \" into\", \" \", util.getDayDate(6).toString().substring(0, 15), \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex flex-column\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Do you want to keep the schedule of the previous week?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex input align-items-center justify-content-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex align-items-center justify-content-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                onChange: e => setPreviousWeekSchedule(e.target.checked ? true : false),\n                type: \"radio\",\n                name: \"pws\",\n                checked: previousWeekSchedule\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"YES\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex align-items-center justify-content-center mx-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                onChange: e => setPreviousWeekSchedule(e.target.checked ? false : true),\n                type: \"radio\",\n                checked: !previousWeekSchedule,\n                name: \"pws\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"NO\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 13\n        }, this), !previousWeekSchedule && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex flex-column\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Location\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              onChange: e => setLocation(e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                selected: true,\n                disabled: true,\n                children: \"Select your location\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 21\n              }, this), doctorData.location.map((l, i) => {\n                return /*#__PURE__*/_jsxDEV(\"option\", {\n                  children: l\n                }, \"location\" + i, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 30\n                }, this);\n              })]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex flex-column\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Appointment Schedule\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"button\",\n              className: \"input\",\n              value: \"Add Timing\",\n              disabled: addTimingDisbaled,\n              onClick: () => addTiming()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex w-100 flex-column justify-content-center\",\n              children: timingArray.map((time, index) => {\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex  justify-content-between\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    className: \"input\",\n                    placeholder: \"Start Time \",\n                    type: \"time\",\n                    value: timingArray[index].start,\n                    onChange: e => modifyStartTiming(index, e.target.value)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 285,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    className: \"input\",\n                    placeholder: \"End Time\",\n                    type: \"time\",\n                    value: timingArray[index].end,\n                    onChange: e => modifyEndTiming(index, e.target.value)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 294,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                    onChange: e => modifyAppointmentsType(index, e.target.value),\n                    value: timingArray[index].type,\n                    className: \"input\",\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      selected: true,\n                      disabled: true,\n                      children: \"Select type\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 310,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: 0,\n                      children: \"Physical\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 313,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: 1,\n                      children: \"Virtual\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 314,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: 2,\n                      children: \"Physical or Virtual\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 315,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: 3,\n                      children: \"Meeting\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 316,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: 4,\n                      children: \"Lunch Break\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 317,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 303,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"button\",\n                    value: \"X\",\n                    className: \"input close\",\n                    onClick: () => deleteTiming(time.id, index)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 319,\n                    columnNumber: 27\n                  }, this)]\n                }, \"time\" + index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 25\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex flex-column\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Select your preffered days\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 331,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex  align-items-center justify-content-center mx-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  name: \"allSelect\",\n                  onChange: e => handleChange(e),\n                  type: \"checkbox\",\n                  checked: daysSelected.length === 7\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Select All\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 339,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 332,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex  align-items-center justify-content-center flex-wrap\",\n                children: daysOfWeek.map((day, i) => {\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"d-flex input align-items-center justify-content-center mx-4\",\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      name: day,\n                      onChange: e => handleChange(e),\n                      type: \"checkbox\",\n                      value: day,\n                      checked: daysSelected.some((item, j) => item === day)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 349,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                      children: day\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 358,\n                      columnNumber: 29\n                    }, this)]\n                  }, \"day\" + i, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 345,\n                    columnNumber: 27\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex flex-column\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"button\",\n            value: \"Validate\",\n            className: \"input\",\n            onClick: () => updateSchedule()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 216,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ScheduleSettings, \"zEZ8/IZ+5CZrsOkdq+QWZVvfTNk=\", false, function () {\n  return [useParams, useNavigate];\n});\n\n_c = ScheduleSettings;\nexport default ScheduleSettings;\n\nvar _c;\n\n$RefreshReg$(_c, \"ScheduleSettings\");","map":{"version":3,"sources":["/home/ma/soulmed-healthcare/src/views/doctor/schedule-settings.js"],"names":["useEffect","useState","useParams","doctorController","Layout","moment","useNavigate","util","ScheduleSettings","id","loading","setLoading","schedueList","setSchdeuleList","doctorData","setDoctorData","name","country","profession_fk","city","Price","location","timingIndexCount","setTimingIndexCount","addTimingDisbaled","setAddTimingDisabled","getDoctorInfo","then","response","data","getDoctorSchedule","res","length","daysOfWeek","timingArray","setTimingarray","addTiming","temp","start","end","type","console","log","deleteTiming","index","filter","timing","modifyStartTiming","value","modifyEndTiming","modifyAppointmentsType","setLocation","daysSelected","setDaysSelected","navigate","updateSchedule","previousWeekSchedule","thisWeekScheduleList","i","previousWeekDay","getDayDate","format","sameDay","daySchedule","push","overlapping","emptyFields","validIntervals","newTimingDates","count","j","doctor_fk","parseInt","indexOf","isOverlapping","isValidTimingInterval","success","alert","addDoctorAppointmentSchedule","handleChange","e","checked","target","tempSelected","item","setPreviousWeekSchedule","toString","substring","map","l","time","day","some"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { doctorController } from \"../../controllers/doctor\";\nimport Layout from \"./layout\";\nimport \"../../css/schedule-settings.css\";\nimport moment from \"moment\";\nimport { useNavigate } from \"react-router-dom\";\nimport { util } from \"../../public/util\";\n\nconst ScheduleSettings = () => {\n  const { id } = useParams();\n  const [loading, setLoading] = useState(true);\n  const [schedueList, setSchdeuleList] = useState([]);\n  const [doctorData, setDoctorData] = useState({\n    id: -1,\n    name: \"\",\n    country: \"\",\n    profession_fk: -1,\n    city: \"\",\n    Price: \"\",\n    location: [],\n  });\n  const [timingIndexCount, setTimingIndexCount] = useState(-1);\n  const [addTimingDisbaled, setAddTimingDisabled] = useState(false);\n  useEffect(() => {\n    doctorController\n      .getDoctorInfo(id)\n      .then((response) => {\n        setDoctorData(response.data);\n      })\n      .then(() => {\n        doctorController\n          .getDoctorSchedule(id)\n          .then((res) => {\n            setSchdeuleList(res.data);\n            setTimingIndexCount(\n              res.data.length > 0 ? res.data[res.data.length - 1].id + 1 : 1\n            );\n          })\n          .then(() => {\n            setLoading(false);\n          });\n      });\n  }, []);\n\n  const daysOfWeek = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"];\n\n  const [timingArray, setTimingarray] = useState([]);\n  const addTiming = () => {\n    setAddTimingDisabled(true);\n    let temp = timingArray;\n    temp = [...temp, { id: timingIndexCount, start: \"\", end: \"\", type: 0 }];\n    setTimingarray(temp);\n\n    setTimingIndexCount(timingIndexCount + 1);\n    console.log(timingArray);\n  };\n  const deleteTiming = (id, index) => {\n    if (index === timingArray.length - 1) {\n      setAddTimingDisabled(false);\n    }\n    let temp = timingArray;\n    temp = timingArray.filter((timing) => timing.id !== id);\n    setTimingarray(temp);\n  };\n\n  const modifyStartTiming = (index, value) => {\n    let temp = [...timingArray];\n    temp[index].start = value;\n\n    setTimingarray(temp);\n  };\n  const modifyEndTiming = (index, value) => {\n    let temp = [...timingArray];\n    temp[index].end = value;\n\n    setTimingarray(temp);\n    if (temp[temp.length - 1].start !== \"\") {\n      setAddTimingDisabled(false);\n    }\n  };\n  const modifyAppointmentsType = (index, value) => {\n    let temp = [...timingArray];\n    temp[index].type = value;\n\n    setTimingarray(temp);\n  };\n\n  const [location, setLocation] = useState(\"\");\n  const [daysSelected, setDaysSelected] = useState([]);\n  const navigate = useNavigate();\n\n  const updateSchedule = () => {\n    if (previousWeekSchedule) {\n      let thisWeekScheduleList = [];\n      for (let i = -7; i <= 0; i++) {\n        let previousWeekDay = moment(util.getDayDate(i)).format(\"YYYY-MM-DD\");\n        for (let i = 0; i < schedueList.length; i++) {\n          if (util.sameDay(schedueList[i].start, previousWeekDay)) {\n            let daySchedule = schedueList[i];\n            daySchedule.id = timingIndexCount;\n            thisWeekScheduleList.push(daySchedule);\n          }\n        }\n      }\n    } else {\n      let overlapping = false;\n      let emptyFields = false;\n      let validIntervals = true;\n      let newTimingDates = [];\n      let count = 0;\n\n      for (let i = 0; i < timingArray.length; i++) {\n        for (let j = 0; j < daysSelected.length; j++) {\n          newTimingDates = [\n            ...newTimingDates,\n            {\n              id: timingArray[i].id,\n              doctor_fk: parseInt(id),\n              start:\n                moment(\n                  util.getDayDate(daysOfWeek.indexOf(daysSelected[j]))\n                ).format(\"YYYY-MM-DD\") +\n                \"T\" +\n                timingArray[i].start,\n              end:\n                moment(\n                  util.getDayDate(daysOfWeek.indexOf(daysSelected[j]))\n                ).format(\"YYYY-MM-DD\") +\n                \"T\" +\n                timingArray[i].end,\n              location: location,\n              type: parseInt(timingArray[i].type),\n            },\n          ];\n\n          count++;\n        }\n      }\n      console.log(newTimingDates);\n\n      for (let i = 0; i < newTimingDates.length; i++) {\n        if (util.isOverlapping(newTimingDates[i], newTimingDates)) {\n          overlapping = true;\n        }\n        if (\n          newTimingDates[i].start === \"\" ||\n          newTimingDates[i].end === \"\" ||\n          newTimingDates[i].type === \"\"\n        ) {\n          emptyFields = true;\n        }\n        if (\n          !util.isValidTimingInterval(\n            newTimingDates[i].start,\n            newTimingDates[i].end\n          )\n        ) {\n          validIntervals = false;\n        }\n      }\n      let success = true;\n      if (overlapping) {\n        alert(\"Two intervals are overlapping\");\n        success = false;\n      }\n      if (emptyFields || location === \"\") {\n        alert(\"Please fill all fields\");\n        success = false;\n      }\n      if (daysSelected.length === 0) {\n        alert(\"Select at least one day\");\n        success = false;\n      }\n      if (!validIntervals) {\n        alert(\"Invalid Timings\");\n        success = false;\n      }\n      if (success) {\n        for (let j = 0; j < newTimingDates.length; j++) {\n          doctorController.addDoctorAppointmentSchedule(newTimingDates[j]);\n        }\n        alert(\"Schedule Updated\");\n        //   navigate(\"/doctor/dashboard/\");\n      }\n    }\n  };\n\n  const handleChange = (e, data) => {\n    const { name, checked } = e.target;\n    if (checked) {\n      // if cheked and selectall checkbox add all fileds to selectedList\n      if (name === \"allSelect\") {\n        let temp = daysOfWeek;\n        setDaysSelected(temp);\n      } else {\n        // if cheked and specific checkbox add specific field to selectedList\n        setDaysSelected([...daysSelected, name]);\n      }\n    } else {\n      // if uncheked and selectall checkbox add remove all fileds from selectedList\n      if (name === \"allSelect\") {\n        setDaysSelected([]);\n      } else {\n        // if uncheked and specific checkbox remove specific field from selectedList\n        let tempSelected = daysSelected.filter((item, i) => item !== name);\n\n        setDaysSelected(tempSelected);\n      }\n    }\n  };\n\n  const [previousWeekSchedule, setPreviousWeekSchedule] = useState(true);\n\n  return (\n    <Layout>\n      {!loading && (\n        <div className=\"d-flex justify-content-center\">\n          <div className=\"col-8 schedule-div\">\n            <h3>\n              Weekly Schedule (From{\" \"}\n              {util.getDayDate(0).toString().substring(0, 15)} into{\" \"}\n              {util.getDayDate(6).toString().substring(0, 15)})\n            </h3>\n            <br />\n            <div className=\"d-flex flex-column\">\n              <span>\n                Do you want to keep the schedule of the previous week?\n              </span>\n              <div className=\"d-flex input align-items-center justify-content-center\">\n                <div className=\"d-flex align-items-center justify-content-center\">\n                  <input\n                    onChange={(e) =>\n                      setPreviousWeekSchedule(e.target.checked ? true : false)\n                    }\n                    type=\"radio\"\n                    name=\"pws\"\n                    checked={previousWeekSchedule}\n                  />\n                  <label>YES</label>\n                </div>\n                <div className=\"d-flex align-items-center justify-content-center mx-4\">\n                  <input\n                    onChange={(e) =>\n                      setPreviousWeekSchedule(e.target.checked ? false : true)\n                    }\n                    type=\"radio\"\n                    checked={!previousWeekSchedule}\n                    name=\"pws\"\n                  />\n                  <label>NO</label>\n                </div>\n              </div>\n            </div>\n            {!previousWeekSchedule && (\n              <>\n                <div className=\"d-flex flex-column\">\n                  <span>Location</span>\n                  <select onChange={(e) => setLocation(e.target.value)}>\n                    <option selected disabled>\n                      Select your location\n                    </option>\n                    {doctorData.location.map((l, i) => {\n                      return <option key={\"location\" + i}>{l}</option>;\n                    })}\n                  </select>\n                </div>\n                <br />\n                <div className=\"d-flex flex-column\">\n                  <span>Appointment Schedule</span>\n                  <input\n                    type=\"button\"\n                    className=\"input\"\n                    value=\"Add Timing\"\n                    disabled={addTimingDisbaled}\n                    onClick={() => addTiming()}\n                  />\n                  <div className=\"d-flex w-100 flex-column justify-content-center\">\n                    {timingArray.map((time, index) => {\n                      return (\n                        <div\n                          key={\"time\" + index}\n                          className=\"d-flex  justify-content-between\"\n                        >\n                          <input\n                            className=\"input\"\n                            placeholder={\"Start Time \"}\n                            type=\"time\"\n                            value={timingArray[index].start}\n                            onChange={(e) =>\n                              modifyStartTiming(index, e.target.value)\n                            }\n                          />\n                          <input\n                            className=\"input\"\n                            placeholder=\"End Time\"\n                            type=\"time\"\n                            value={timingArray[index].end}\n                            onChange={(e) =>\n                              modifyEndTiming(index, e.target.value)\n                            }\n                          />\n                          <select\n                            onChange={(e) =>\n                              modifyAppointmentsType(index, e.target.value)\n                            }\n                            value={timingArray[index].type}\n                            className=\"input\"\n                          >\n                            <option selected disabled>\n                              Select type\n                            </option>\n                            <option value={0}>Physical</option>\n                            <option value={1}>Virtual</option>\n                            <option value={2}>Physical or Virtual</option>\n                            <option value={3}>Meeting</option>\n                            <option value={4}>Lunch Break</option>\n                          </select>\n                          <input\n                            type=\"button\"\n                            value={\"X\"}\n                            className=\"input close\"\n                            onClick={() => deleteTiming(time.id, index)}\n                          />\n                        </div>\n                      );\n                    })}\n                  </div>\n                  <br />\n                  <div className=\"d-flex flex-column\">\n                    <label>Select your preffered days</label>\n                    <div className=\"d-flex  align-items-center justify-content-center mx-4\">\n                      <input\n                        name=\"allSelect\"\n                        onChange={(e) => handleChange(e)}\n                        type=\"checkbox\"\n                        checked={daysSelected.length === 7}\n                      />\n                      <label>Select All</label>\n                    </div>\n                    <br />\n                    <div className=\"d-flex  align-items-center justify-content-center flex-wrap\">\n                      {daysOfWeek.map((day, i) => {\n                        return (\n                          <div\n                            key={\"day\" + i}\n                            className=\"d-flex input align-items-center justify-content-center mx-4\"\n                          >\n                            <input\n                              name={day}\n                              onChange={(e) => handleChange(e)}\n                              type=\"checkbox\"\n                              value={day}\n                              checked={daysSelected.some(\n                                (item, j) => item === day\n                              )}\n                            />\n                            <label>{day}</label>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                  <br />\n                </div>\n              </>\n            )}\n            <div className=\"d-flex flex-column\">\n              <input\n                type=\"button\"\n                value={\"Validate\"}\n                className=\"input\"\n                onClick={() => updateSchedule()}\n              />\n            </div>\n          </div>\n        </div>\n      )}\n    </Layout>\n  );\n};\n\nexport default ScheduleSettings;\n"]},"metadata":{},"sourceType":"module"}